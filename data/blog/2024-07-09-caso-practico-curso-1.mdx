---
title: Caso pr谩ctico curso Especialista en Inteligencia Artificial - D铆a 1
date: '2024-07-09'
tags: ['aprendizajes', 'inteligencia artificial', 'curso especialista IA']
draft: false
summary: Este es el primer de varios art铆culos en los que detallo como defino y desarrollo el caso pr谩ctico para el curso de Especialista en Inteligencia Artificial que estoy realizando.
---

<TOCInline toc={props.toc} />


# Introducci贸n

En el contexto del curso que estoy realizando de Especialista en Inteligencia Artificial, se nos ha presentado la oportunidad de realizar un caso pr谩ctico. Es una oportunidad para plasmar los conocimientos adquiridos y desarrollar nuevos.
Nos han brindado la oportunidad de proponer proyectos. Y hay dos (muy diferentes) que me interesan mucho.

## Investigando posibles proyectos que he propuesto

- Predicci贸n del precio de una acci贸n con ML.
- Detecci贸n de rostros y reconocimiento facial.

## Proyecto escogido: Detecci贸n de rostros y reconocimiento facial

- He experimentado con Tensorflow.js en el pasado y me ha parecido interesante.
- Es un proyecto divertido en el que voy a incluir a mis hijos
	- Especialmente a Aratz (el peque帽o de 7 a帽os), al que le interesa mucho la interacci贸n con computadoras. Le regal茅 un lector de tarjetas RFID y se pasa el dia interactuando con ellas y el ordenador. Le va a gustar ver y participar en un proyecto como este y quiz谩 incluso podemos 隆integrar su lector en el futuro!
- De todo lo que he aprendido hasta ahora sobre inteligencia artificial, la Visi贸n por Computaci贸n es probablemente uno de los campos que m谩s me interesa. Por sus aplicaciones en muchos 谩mbitos: sanidad, seguridad, cadenas de producci贸n.
- Sobretodo: creo que es algo que voy a disfrutar y que puedo seguir desarrollando y mejorando en el futuro .

## Como estoy planteando el proyecto

- Quiero aprovechar mi experiencia en el entorno Cloud Native y por ello el proyecto estar谩 "containerizado". Se que hay aplicaciones similares y much铆simo mas avanzadas a la mia, pero es una buena oportunidad para crear un proyecto que potencialmente se puede desplegar en un entorno Docker o incluso un cluster de k8s.
- Es una oportunidad para mejorar y desarrollar mis conocimientos de project manager/product owner. Voy  a hacer una buena definici贸n de los requerimientos del proyecto, documentarlo y hacer un seguimiento del desarrollo. No creo que llegue a plantearme un Kanban, aunque a lo mejor me vengo arriba y lo acabo haciendo .

## Empezamos investigando como lo podemos implementar y creando un repositorio en GitHub

Para la investigaci贸n me he servido principalmente de diferentes fuentes de internet, tango mediante Google como Youtube. Se encuentran infinidad de enfoques y diferentes usos de librer铆as. Tambien tengo el libro del curso. He decidido inicialmente documentar los requerimientos y la implementaci贸n bas谩ndome en lo que he visto en diferentes fuentes. Es probable que tenga que revisar este documento en un futuro.
La aplicaci贸n tiene dos partes bien definidias:
- Un modelo de aprendizaje y detecci贸n de rostros
- Un servidor web que muestra el video y los datos en el cliente a la vez que actualiza interactua con la API de Google Sheets
La implementaci贸n del servidor web y la interacci贸n con la API de Google Sheets es algo que conozco de otros experimentos pasados y creo que es la parte que conozco mejor.

Una vez he acabado mi investigaci贸n, he creado un repositorio en GitHub con un archivo Readme lo mas completo posible. Siempre he sido un f茅rreo defensor del enfoque Lean, de hacer algo r谩pido e iterar. Pero por mi pasada experiencia en proyectos de software, se que no est谩 de mas tener una documentaci贸n lo m谩s detallada posible.
El c贸digo se encuentra en el siguiente repositorio: https://github.com/jhmarina/app-reconocimiento-facial. 

## Definici贸n del proyecto

> Esta es una aplicaci贸n web que utiliza la detecci贸n y el reconocimiento facial en tiempo real. La aplicaci贸n detecta rostros utilizando un modelo preentrenado y muestra el nombre de la persona detectada junto con la hora de la detecci贸n. Estos datos ser谩n accesibles en una p谩gina web a tiempo real. A Estos datos quedar谩n tambi茅n registrados en una hoja de Google Sheets.

Ese ser铆a el objetivo del proyecto. Creo que es algo ambicioso, pero disponemos de 60 horas para realizarlo. Creo que es factible. 

### 驴C贸mo funcionar谩 el modelo de aprendizaje?

- Recopilaci贸n de Datos: Se recopilan im谩genes de entrenamiento de diferentes personas con sus respectivas etiquetas (nombres).
- Preprocesamiento de Datos: Las im谩genes se preprocesan, por ejemplo, ajustando su tama帽o y formato.
- Entrenamiento del Modelo:
    - Detecci贸n de Rostros con dlib: Se utiliza dlib para detectar rostros en las im谩genes.
    - Extracci贸n de Caracter铆sticas: Se extraen caracter铆sticas faciales importantes de cada rostro.
    - Codificaci贸n de Rostros: Las caracter铆sticas faciales se codifican en un vector de caracter铆sticas num茅ricas.
    - Comparaci贸n con Rostros Conocidos: Las codificaciones de los rostros se comparan con las codificaciones de rostros conocidos para entrenar el modelo de reconocimiento.
- Validaci贸n del Modelo: Se valida la precisi贸n del modelo con un conjunto de datos de validaci贸n.
- Guardado del Modelo: El modelo entrenado (codificaciones faciales y etiquetas) se guarda en un archivo para su uso posterior.
- Implementaci贸n en la Aplicaci贸n: El modelo guardado se implementa en la aplicaci贸n web para realizar la detecci贸n y el reconocimiento facial en tiempo real.

![Esquema que describe como funciona el modelo de aprendizaje](/static/img/especialista-ia/mermaid-modelo-aprendizaje.jpg "image_tooltip")

### 驴C贸mo funcionar谩 la aplicaci贸n web?

- Usuario: El usuario accede a la aplicaci贸n web desde su navegador.
- Servidor Flask: El servidor Flask recibe la solicitud de acceso a la web.
- Captura de Video con OpenCV: El servidor Flask solicita el feed de video, y OpenCV captura los frames de video en tiempo real.
- Detecci贸n y Reconocimiento Facial: Los frames de video se procesan para detectar y reconocer rostros utilizando la biblioteca face_recognition.
- Actualiza Detecciones: Las detecciones (nombre y hora) se almacenan en una lista en memoria.
- Env铆a Datos a Google Sheets: Los datos de detecci贸n se env铆an a Google Sheets utilizando la API de Google Sheets.
- Hoja de Google Sheets: Los datos se guardan en una hoja de Google Sheets.
- Retorna Video con Detecciones: Los frames procesados se env铆an de vuelta al servidor Flask, que los retorna al navegador del usuario.
- Renderiza Video: El navegador del usuario renderiza el video con las detecciones superpuestas.
- API de Detecciones: Cuando el navegador solicita las detecciones, el servidor Flask responde con un JSON que contiene las detecciones almacenadas.
- Tabla de Detecciones en HTML: El navegador del usuario actualiza la tabla de detecciones en la interfaz web cada 5 segundos con la informaci贸n recibida de la API de detecciones.

![Esquema que describe como funciona el servidor web](/static/img/especialista-ia/mermaid-servidor-web.jpg "image_tooltip")

## Fin del primer dia trabajando en el caso pr谩ctico

Con esto acabo el primer dia de trabajo en el caso pr谩ctico. El pr贸ximo dia empiezo a implementar estas ideas con c贸digo. Estoy convencido de que parte de lo que he documentado variar谩, estoy planteando conceptos bas谩ndome en lo que he investigado y aun no s茅 exactamente c贸mo los voy a implementar.